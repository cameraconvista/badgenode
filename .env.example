# BadgeNode - Environment Variables Template
# Copia questo file in .env.local per sviluppo locale

# ===========================================
# SUPABASE CONFIGURATION (REQUIRED)
# ===========================================

# Client-side Supabase (con prefisso VITE_ per Vite)
VITE_SUPABASE_URL=https://<your-project>.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Server-side Supabase (SENZA prefisso VITE_)
# ⚠️  CRITICAL: SERVICE_ROLE_KEY deve rimanere server-only
SUPABASE_URL=https://<your-project>.supabase.co
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# ===========================================
# APPLICATION CONFIGURATION
# ===========================================

# Server port (default: 3001)
PORT=3001

# Read-Only Mode (1=enabled, 0=disabled)
# Quando attivo, blocca tutte le operazioni di scrittura
READ_ONLY_MODE=0

# ===========================================
# DEVELOPMENT CONFIGURATION
# ===========================================

# Node environment (development/production)
NODE_ENV=development

# Enable debug logging (1=enabled, 0=disabled)
DEBUG_ENABLED=0

# ===========================================
# OFFLINE QUEUE CONFIGURATION
# ===========================================

# Abilita sistema offline queue (true/false)
VITE_FEATURE_OFFLINE_QUEUE=true

# Abilita badge diagnostico offline (true/false) 
VITE_FEATURE_OFFLINE_BADGE=true

# Whitelist device autorizzati per offline (CSV)
# Per produzione: sostituire con device ID reali
# Per ottenere device ID: window.__BADGENODE_DIAG__.offline.deviceId
VITE_OFFLINE_DEVICE_WHITELIST=BN_DEV_localhost_demo,BN_TABLET_PRODUZIONE_01,BN_TABLET_PRODUZIONE_02

# Abilita validazione business logic offline (true/false)
# Controlla alternanza ENTRATA/USCITA in modalità offline
VITE_OFFLINE_VALIDATION_ENABLED=true

# ===========================================
# OPTIONAL CONFIGURATION
# ===========================================

# Database URL (se diverso da Supabase)
# DATABASE_URL=postgresql://user:pass@localhost:5432/badgenode

# Session secret per autenticazione admin
# SESSION_SECRET=your-random-secret-key

# Backup retention (numero di backup da mantenere)
BACKUP_RETENTION=3

# File length guard strict mode (1=enabled, 0=disabled)
STRICT_220=true

# ===========================================
# PRODUCTION NOTES
# ===========================================

# Per produzione su Render:
# 1. Configura le variabili Supabase nel dashboard Render
# 2. Imposta READ_ONLY_MODE=0 solo dopo verifica completa
# 3. NODE_ENV=production viene impostato automaticamente
# 4. PORT viene fornito da Render automaticamente
# 5. OFFLINE QUEUE: Sostituire VITE_OFFLINE_DEVICE_WHITELIST con device ID reali

# Offline Queue Setup:
# 1. Accedi all'app su ogni device di produzione
# 2. Apri DevTools → Console
# 3. Esegui: window.__BADGENODE_DIAG__.offline.deviceId
# 4. Aggiungi gli ID reali a VITE_OFFLINE_DEVICE_WHITELIST (separati da virgola)
# 5. Redeploy su Render

# Security checklist:
# ✅ SERVICE_ROLE_KEY mai esposta al client
# ✅ ANON_KEY ha RLS policies attive
# ✅ Nessun segreto committato in git
# ✅ Variabili ambiente validate al boot
# ✅ OFFLINE: Mai usare * in VITE_OFFLINE_DEVICE_WHITELIST in produzione
